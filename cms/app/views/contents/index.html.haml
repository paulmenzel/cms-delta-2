.container
  .row
    .span3
      = render 'projects/menu'  
    
    .span6

      %h1
        - if @content_type 
          = @content_type.name
        - else
          Alles

        - if @branch
          %strong
            %i.fa.fa-double-angle-right
            = @branch.route(@locale).name
        
          
        
        %small.pull-right
          - @project.languages.each do |lng|
            - btnclass = 'btn-inverse' if @locale.to_s == lng.to_s
            = link_to url_for(params.merge(:locale => lng)), :class => "btn btn-mini #{btnclass}" do
              = lng 

      
      %table.table.table-condensed.table-striped.table-bordered.table-hover
        %tr
          - if @branch
            %th{:width => 5}
          
          %th Titel
          %th
          - unless @content_type
            %th Inhaltstyp
          %th
          %th
      
        %tbody{ :class => "#{'sortable' if @branch}", :data => { :update => { :url => (@branch) ? sort_project_branch_path(@project, @branch) : '' } } }
          - puts @contents
          - @contents.each do |content|
          
            %tr{ :id => "content_#{content.id}", :width => '100%' }
              - if @branch
                %td.handle
                  
              
              %td
                = link_to project_content_type_content_path(@project, content.content_type, content, params.merge(:locale => @locale)) do
                  = content.rep(@locale).html_safe
                  
  
              %td
                - unless content.branches.empty?
                  %strong.muted{ :rel => "tooltip", :data => {:toggle=>"tooltip", :placement=>"top", :original_title => "#{ content.branches.map{ |b| b.route(@locale).name }.join("\n") }"  } }
                    %i.fa.fa-sitemap.fa-fw

                - unless content.workspaces.empty?
                  %strong.muted{ :rel => "tooltip", :data => {:toggle=>"tooltip", :placement=>"top", :original_title => "#{ content.workspaces.map{ |w| w.name }.join("\n") }"  } }
                    %i.fa.fa-desktop.fa-fw

                - if content.user
                  %small.muted{ :title => l( content.updated_at ) }
                    %i.fa.fa-lock.fa-fw{ :rel => "tooltip", :data => {:toggle=>"tooltip", :placement=>"top", :original_title => "#{ content.user.username } - "  } }
                
              - unless @content_type
                %td= content.content_type.name
  
  
              %td{ :width => 45 }
                - content.languages.each do |lng|
                  = image_tag asset_path("flags/#{lng}.png")
                  
              %td{ :width => 50 }
                = render :partial => 'content_actions', :locals => { :content => content }

                
      
      - if @content_type
        = link_to new_project_content_type_content_path(@project, @content_type, params.merge(:branch => @branch)), :class => 'btn btn-mini btn-primary pull-right' do 
          %i.fa.fa-plus
          &nbsp;
          Neuen
          %strong
            = @content_type.name
          anlegen
      


    .span3
      %h1
        Sitemap
        
      #sitemap.well.navi
        %ul.nested_branches.contents
          = sitemap @branches.arrange(:order => :position) 